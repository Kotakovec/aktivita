<!DOCTYPE html>
<html lang="cs">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Status Práce Firebase</title>
<style>
  body, html {
    margin: 0; padding: 0; height: 100%;
    background: black;
    display: flex; justify-content: center; align-items: center;
    font-family: Arial, sans-serif;
  }
  #text {
    font-size: 3em;
    user-select: none;
    color: limegreen;
  }
  #controlBtn {
    position: fixed;
    top: 10px;
    right: 10px;
    font-size: 20px;
    background: none;
    border: none;
    color: white;
    cursor: pointer;
    user-select: none;
    text-decoration: underline;
    padding: 0;
  }
  #controlBtn:hover {
    color: #0f0;
  }
</style>
</head>
<body>

<div id="text">Načítám...</div>
<button id="controlBtn">control</button>

<!-- Firebase SDK -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>

<script>
  // Firebase konfigurace
  const firebaseConfig = {
    apiKey: "AIzaSyB2GfCg7OQfw4QlO85Dk2js_zsr76gmiQc",
    authDomain: "status-d3164.firebaseapp.com",
    databaseURL: "https://status-d3164-default-rtdb.firebaseio.com",
    projectId: "status-d3164",
    storageBucket: "status-d3164.firebasestorage.app",
    messagingSenderId: "889015018548",
    appId: "1:889015018548:web:eaae16ad4ac16545e69661",
    measurementId: "G-F28FJ65P3K"
  };

  // Inicializace Firebase
  firebase.initializeApp(firebaseConfig);

  const db = firebase.database();
  const stavRef = db.ref('stav');

  const textElem = document.getElementById('text');
  const btn = document.getElementById('controlBtn');

  // Aktualizace textu a barvy podle stavu
  function updateText(stav) {
    textElem.textContent = stav;
    if (stav === 'Pracuje') {
      textElem.style.color = 'limegreen';
    } else if (stav === 'Neaktivní') {
      textElem.style.color = 'red';
    } else {
      textElem.style.color = 'gray';
    }
  }

  // Posloucháme realtime změny stavu v databázi
  stavRef.on('value', (snapshot) => {
    const stav = snapshot.val();
    if (stav) {
      updateText(stav);
    } else {
      updateText('Neaktivní'); // výchozí pokud prázdné
      stavRef.set('Neaktivní');
    }
  });

  // Po kliknutí přepínáme stav a ukládáme do databáze
  btn.addEventListener('click', () => {
    const current = textElem.textContent;
    const next = current === 'Pracuje' ? 'Neaktivní' : 'Pracuje';
    stavRef.set(next);
  });
</script>

</body>
</html>
