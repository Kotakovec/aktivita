<!DOCTYPE html>
<html lang="cs">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Pracovní doba</title>
  <style>
    html, body {
      margin: 0;
      padding: 0;
      height: 100%;
      background: black;
      color: white;
      font-family: Arial, sans-serif;
    }

    .container {
      display: flex;
      flex-direction: column;
      justify-content: flex-start;
      align-items: center;
      padding: 30px;
      height: 100vh;
    }

    .header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      width: 100%;
      max-width: 400px;
      font-size: 1.4em;
      margin-bottom: 40px;
    }

    #controlBtn {
      font-size: 14px;
      background: none;
      border: none;
      color: white;
      cursor: pointer;
      text-decoration: underline;
    }

    .schedule {
      width: 100%;
      max-width: 400px;
    }

    .row {
      display: flex;
      justify-content: space-between;
      margin: 10px 0;
      padding: 10px;
      background: #111;
      border-radius: 4px;
      cursor: pointer;
    }

    .row:hover {
      background: #222;
    }

    .modal-bg {
      position: fixed;
      top: 0; left: 0; right: 0; bottom: 0;
      background: rgba(0,0,0,0.7);
      display: none;
      justify-content: center;
      align-items: center;
      z-index: 1000;
    }

    .modal {
      background: #222;
      padding: 20px 30px;
      border-radius: 8px;
      box-shadow: 0 0 10px #0f0;
      color: white;
      text-align: center;
      max-width: 300px;
    }

    .modal input {
      width: 100%;
      padding: 10px;
      margin: 15px 0;
      font-size: 1em;
      border-radius: 4px;
      border: none;
    }

    .modal button {
      margin: 5px;
      padding: 8px 12px;
      font-size: 1em;
      border-radius: 5px;
      border: none;
      background-color: #333;
      color: white;
      cursor: pointer;
    }

    .modal button:hover {
      background-color: #0a0;
    }

    .modal .close-btn {
      background-color: #900;
    }

    .modal .close-btn:hover {
      background-color: #f00;
    }
  </style>
</head>
<body>

<div class="container">
  <div class="header">
    <div>Pracovní doba</div>
    <button id="controlBtn">control</button>
  </div>

  <div class="schedule" id="schedule">
    <!-- Dny se generují pomocí JS -->
  </div>
</div>

<!-- Modal: Heslo -->
<div id="passwordModal" class="modal-bg">
  <div class="modal">
    <div>Zadej heslo:</div>
    <input type="password" id="passwordInput" autocomplete="off" />
    <div>
      <button id="passwordSubmit">Potvrdit</button>
      <button class="close-btn" onclick="closeModal()">Zavřít</button>
    </div>
    <div id="passwordError" style="color: #f55; margin-top:10px; display:none;">Špatné heslo!</div>
  </div>
</div>

<!-- Modal: Úprava dne -->
<div id="editModal" class="modal-bg">
  <div class="modal">
    <div id="editDayLabel">Den:</div>
    <input type="text" id="editValue" placeholder="Např. 8:00 - 16:00" />
    <div>
      <button id="saveDay">Uložit</button>
      <button class="close-btn" onclick="closeEdit()">Zavřít</button>
    </div>
  </div>
</div>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
<script>
  const firebaseConfig = {
    apiKey: "AIzaSyB2GfCg7OQfw4QlO85Dk2js_zsr76gmiQc",
    authDomain: "status-d3164.firebaseapp.com",
    databaseURL: "https://status-d3164-default-rtdb.firebaseio.com",
    projectId: "status-d3164",
    storageBucket: "status-d3164.appspot.com",
    messagingSenderId: "889015018548",
    appId: "1:889015018548:web:eaae16ad4ac16545e69661"
  };

  firebase.initializeApp(firebaseConfig);
  const db = firebase.database();
  const ref = db.ref("tyden");

  const dny = ["Pondělí", "Úterý", "Středa", "Čtvrtek", "Pátek", "Sobota", "Neděle"];
  const schedule = document.getElementById("schedule");
  let isAdmin = false;
  let selectedDayIndex = null;

  const passwordModal = document.getElementById("passwordModal");
  const passwordInput = document.getElementById("passwordInput");
  const passwordSubmit = document.getElementById("passwordSubmit");
  const passwordError = document.getElementById("passwordError");
  const editModal = document.getElementById("editModal");
  const editValue = document.getElementById("editValue");
  const editDayLabel = document.getElementById("editDayLabel");
  const saveDayBtn = document.getElementById("saveDay");

  const adminPassword = "frconzole24";

  function renderSchedule(data = {}) {
    schedule.innerHTML = "";
    dny.forEach((den, i) => {
      const row = document.createElement("div");
      row.className = "row";
      row.innerHTML = `<div>${den}</div><div id="value-${i}">${data[i] || "8:00 - 16:00"}</div>`;
      row.addEventListener("click", () => {
        if (!isAdmin) return;
        selectedDayIndex = i;
        editDayLabel.textContent = den;
        editValue.value = data[i] || "";
        editModal.style.display = "flex";
      });
      schedule.appendChild(row);
    });
  }

  ref.on("value", (snap) => {
    const data = snap.val() || {};
    renderSchedule(data);
  });

  document.getElementById("controlBtn").addEventListener("click", () => {
    if (isAdmin) return;
    passwordInput.value = "";
    passwordError.style.display = "none";
    passwordModal.style.display = "flex";
    passwordInput.focus();
  });

  passwordSubmit.addEventListener("click", () => {
    if (passwordInput.value === adminPassword) {
      isAdmin = true;
      passwordModal.style.display = "none";
    } else {
      passwordError.style.display = "block";
    }
  });

  passwordInput.addEventListener("keydown", e => {
    if (e.key === "Enter") passwordSubmit.click();
  });

  saveDayBtn.addEventListener("click", () => {
    const value = editValue.value.trim();
    ref.child(selectedDayIndex).set(value);
    editModal.style.display = "none";
  });

  editValue.addEventListener("keydown", e => {
    if (e.key === "Enter") saveDayBtn.click();
  });

  function closeModal() {
    passwordModal.style.display = "none";
  }

  function closeEdit() {
    editModal.style.display = "none";
  }
</script>

</body>
</html>